(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{374:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing.b1483dba.png"},375:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing2.47abb421.png"},376:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing3.027e5201.png"},377:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing4.2c183d74.png"},378:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy.01c59b58.png"},379:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy2.2e6c3e27.png"},380:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy3.23515811.png"},381:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate.8c12825c.png"},382:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate2.ed79e9b6.png"},383:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate3.3eba41ed.png"},384:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Policy.9d6aad48.png"},385:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Policy2.ab41e47b.png"},386:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Thing.5e692f8e.png"},387:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Thing2.06771663.png"},388:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Find_Endpoint.a38acfc5.png"},389:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_result_MQTT.b8e18113.png"},490:function(t,a,e){"use strict";e.r(a);var s=e(45),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"integrate-aws-iot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#integrate-aws-iot"}},[t._v("#")]),t._v(" Integrate AWS IOT")]),t._v(" "),s("h2",{attrs:{id:"create-a-thing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-thing"}},[t._v("#")]),t._v(" Create a thing")]),t._v(" "),s("ul",[s("li",[t._v("From AWS console, search for IOT core")]),t._v(" "),s("li",[t._v("Create a Thing and name it, this name will be used as the OpenMQTTGateway name.")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(374),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(375),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(376),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(377),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"create-a-policy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-policy"}},[t._v("#")]),t._v(" Create a policy")]),t._v(" "),s("p",[s("img",{attrs:{src:e(378),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(379),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(380),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("Add this json code to the policy")])]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-11-01"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Statement"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Effect"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Allow"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Action"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Connect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Publish"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Subscribe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Receive"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"greengrass:Discover"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Resource"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("h2",{attrs:{id:"create-a-certificate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-certificate"}},[t._v("#")]),t._v(" Create a certificate")]),t._v(" "),s("ul",[s("li",[t._v("Create a new certificate")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(381),alt:""}}),t._v(" "),s("img",{attrs:{src:e(382),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("Download certificates and key")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(383),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"attach-policy-with-certificate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#attach-policy-with-certificate"}},[t._v("#")]),t._v(" Attach Policy with certificate")]),t._v(" "),s("p",[s("img",{attrs:{src:e(384),alt:""}}),t._v(" "),s("img",{attrs:{src:e(385),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"activate-certificate-and-attach-it-to-thing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#activate-certificate-and-attach-it-to-thing"}},[t._v("#")]),t._v(" Activate certificate and attach it to Thing")]),t._v(" "),s("p",[s("img",{attrs:{src:e(386),alt:""}}),t._v(" "),s("img",{attrs:{src:e(387),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"find-aws-endpoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#find-aws-endpoint"}},[t._v("#")]),t._v(" Find AWS EndPoint")]),t._v(" "),s("p",[s("img",{attrs:{src:e(388),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"gather-the-information-for-openmqttgateway-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gather-the-information-for-openmqttgateway-configuration"}},[t._v("#")]),t._v(" Gather the information for OpenMQTTGateway configuration")]),t._v(" "),s("p",[t._v("Now you should have the following information for the OpenMQTTGateway configuration:")]),t._v(" "),s("ul",[s("li",[t._v("Root certificate")]),t._v(" "),s("li",[t._v("Client certificate")]),t._v(" "),s("li",[t._v("Client key")]),t._v(" "),s("li",[t._v("End point url")]),t._v(" "),s("li",[t._v("Gateway name")])]),t._v(" "),s("h2",{attrs:{id:"modify-openmqttgateway-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modify-openmqttgateway-configuration"}},[t._v("#")]),t._v(" Modify OpenMQTTGateway configuration")]),t._v(" "),s("p",[t._v("With Arduino IDE, you can update the following field into User_config.h with the information gathered:")]),t._v(" "),s("ul",[s("li",[t._v("Gateway_Name")]),t._v(" "),s("li",[s("code",[t._v('MQTT_SERVER "xxxxxx.iot-eu-amazonaws.com"')])]),t._v(" "),s("li",[s("code",[t._v('MQTT_PORT "8883"')])]),t._v(" "),s("li",[s("code",[t._v("AWS_IOT true")])]),t._v(" "),s("li",[t._v("ss_server_cert with the root certificate")]),t._v(" "),s("li",[t._v("ss_client_cert with the client certificate")]),t._v(" "),s("li",[t._v("ss_client_key with the Client key")]),t._v(" "),s("li",[s("code",[t._v("MQTT_SECURE_SELF_SIGNED 1")])]),t._v(" "),s("li",[s("code",[t._v("MQTT_SECURE_DEFAULT true")])])]),t._v(" "),s("p",[t._v("With PlatformIO you can directly leverage the environment "),s("code",[t._v("esp32dev-ble-aws")])]),t._v(" "),s("h2",{attrs:{id:"build-and-upload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#build-and-upload"}},[t._v("#")]),t._v(" Build and upload")]),t._v(" "),s("h2",{attrs:{id:"connect-to-a-wifi-access-point-see-portal"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-a-wifi-access-point-see-portal"}},[t._v("#")]),t._v(" Connect to a wifi Access point "),s("a",{attrs:{href:"../upload/portal"}},[t._v("see portal")])]),t._v(" "),s("p",[t._v("Enter your credentials and verify that Secure connection is marked.")]),t._v(" "),s("h2",{attrs:{id:"verify-that-you-receive-data-in-aws"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#verify-that-you-receive-data-in-aws"}},[t._v("#")]),t._v(" Verify that you receive data in AWS")]),t._v(" "),s("ul",[s("li",[t._v("Go to things")]),t._v(" "),s("li",[t._v("Click on the thing created")]),t._v(" "),s("li",[t._v("Go to Activity")]),t._v(" "),s("li",[t._v("Click on MQTT Test Client")]),t._v(" "),s("li",[t._v("Subscribe to "),s("code",[t._v("+/#")])])]),t._v(" "),s("p",[t._v("You should see messages coming.")]),t._v(" "),s("p",[s("img",{attrs:{src:e(389),alt:""}})])])}),[],!1,null,null,null);a.default=n.exports}}]);